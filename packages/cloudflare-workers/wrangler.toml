name = "botcha"
main = "dist/index.js"
compatibility_date = "2025-01-30"
compatibility_flags = ["nodejs_compat"]
account_id = "82c70a74dfe2b9802a95ddac893a4da8"

# Route API endpoints to the worker on main domain
routes = [
  { pattern = "botcha.ai", zone_name = "botcha.ai" },
  { pattern = "botcha.ai/api/*", zone_name = "botcha.ai" },
  { pattern = "botcha.ai/v1/*", zone_name = "botcha.ai" },
  { pattern = "botcha.ai/agent-only", zone_name = "botcha.ai" },
  { pattern = "botcha.ai/badge/*", zone_name = "botcha.ai" },
  { pattern = "botcha.ai/health", zone_name = "botcha.ai" }
]

# Environment variables
[vars]
BOTCHA_VERSION = "0.3.2"
# JWT_SECRET is stored securely via: wrangler secret put JWT_SECRET

# KV namespace for challenge storage
[[kv_namespaces]]
binding = "CHALLENGES"
id = "1bbfbe23060a450f996a587a36501a65"

# Rate limiting KV namespace
[[kv_namespaces]]
binding = "RATE_LIMITS"
id = "c45e9f02ad104ad98d00699db3ad258c"

# Analytics Engine binding for usage tracking
[[analytics_engine_datasets]]
binding = "ANALYTICS"

# Local development settings (must be last to avoid capturing other fields)
[dev]
port = 8787
local_protocol = "http"
